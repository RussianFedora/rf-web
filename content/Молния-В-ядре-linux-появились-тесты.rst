.. title: Молния! В ядре Linux появились тесты!
.. slug: Молния-В-ядре-linux-появились-тесты
.. date: 2013-02-28 12:33:04
.. tags: kernel, testing
.. category:
.. link:
.. description:
.. type: text
.. author: Peter Lemenkov

**Это архивная статья**


Как известно, за 22 года существования ядра Linux никакого
регрессионного тестирования в него включено не было. Патчи оценивались
на глазок, и по принципу "собрал, Emacs вроде запускается". Это,
конечно, очень печальная практика, и ходят слухи, что некоторые компании
пытались создавать с разной степенью успешность внутрикорпоративные
системы регрессионного тестирования. Из-за отсутствия автотестов
производители были вынуждены прилипать к конкретным версиям ядра,
которые потихоньку устаревали. Несмотря на то, что возможности по
переходу на новые версии у производителей были, никто не хотел начинать
тестирование по новой, с новой версией ядра, в которой неизвестно, что
поломали. Это, конечно, вносило еще больше так прославляемых некоторыми
любителями "юниксвэя" вариантов выбора в ландшафт - пытаясь найти
подходящее "железячное" решение пользователь **вынужден** был выбирать и
версию ядра к нему.

Но и мы, простые пользователи, сталкиваемся с последствиями этого
регулярно. Несмотря на заверения одного хулигана и матершинника, что "WE
DO NOT BREAK USERSPACE!", это, очевидно, не распространяется на драйверы
- форумы и твиттеры забиты `ненавистью <http://lurkmore.to/Ненависть>`__
простых пользователей, когда после обновления ядра у них не работает
Wi-Fi, отвалился звук, появились артефакты видеокарты, или ничего не
работает:

.. image:: http://habrastorage.org/storage2/aa4/838/050/aa4838050cfbc1d949bda5107551c4dd.jpeg
   :align: center

*Типичная ситуация - ядро Linux после обновления на новую версию.*

Сложившееся положение шокировало начинающих разработчиков - на
недоуменные вопросы о том, `как же тестируются изменения
Linux <http://stackoverflow.com/questions/3177338/how-is-linux-kernel-tested>`__,
следовали пугающие своей однозначностью ответы - а никак (см. "собрал,
Emacs вроде запускается"). Это было б еще ничего, если б это касалось
только пользователей и разработчиков, но и лицам, **принимающим
решения**, также не нравилось то, что они видели. Ситуация становилась
вопиюще неприемлемой.

И вот, впервые в Linux-ядре, инженеры Red Hat представили `систему
самотестирования <http://git.kernel.org/?p=linux/kernel/git/torvalds/linux-2.6.git;a=tree;f=tools/testing/selftests;hb=HEAD>`__.

Основную работу провел `Frédéric
Weisbecker <https://plus.google.com/117369405244904963316/about>`__
(есть `интервью с
ним <http://www.linux.com/news/special-feature/linux-developers/690132-30-linux-kernel-developers-in-30-weeks-frederic-weisbecker>`__),
за что ему огромное спасибо! Также надо отметить тех, кто ему помог
довести сделанное до уровня, позволяющего включить в ядро - в этом ему
помогли его коллеги из Red Hat - `Dave
Young <http://www.linkedin.com/pub/dave-young/4b/a01/a4b>`__, `Doug
Ledford <https://plus.google.com/117724629050905786176/about>`__, `Dave
Jones <https://www.openhub.net/accounts/davej>`__, наши соотечественники
из Parallels - `Cyrill
Gorcunov <https://plus.google.com/104753339591125116999/about>`__,
Stanislav Kinsbursky, и многие другие.

Об улучшении уже `тепло отозвался в своей ленте
Google+ <https://plus.google.com/111049168280159033135/posts/VZq3iKd5AFY>`__
известный гентушник и дистрохоппер `Greg
Kroah-Hartman <http://www.kroah.com/log/>`__.
