.. title: Что там у systemd?
.. slug: Что-там-у-systemd
.. date: 2016-04-13 15:50:32
.. tags: systemd, kdbus, docker, bsd, github, bmw, automotive
.. category:
.. link:
.. description:
.. type: text
.. author: Peter Lemenkov

За последнее время было не так много новостей о systemd, и даже `выходы
новой версии <https://www.opennet.ru/opennews/art.shtml?num=43862>`__
больше не ошеломляют. Дело в том, что самые большие новости о systemd в
том, что не сделано, и чего планируют переделать. Об этом и поговорим.

Долгожданная функциональность управления пользовательскими сессиями,
`systemd user
sessions </content/Часть-функциональности-gnome-kde-и-xfce-переносят-в-systemd>`__,
к сожалению, `не будет
использоваться <https://bugzilla.redhat.com/1198655#c4>`__. Ее
запланировали полностью переработать. Ну жаль, что. Будем надеяться, что
переделка не займет еще четыре года.

Под нож пошла и `функциональность
kdbus </content/Перенос-d-bus-в-ядро-linux>`__, которую `недавно
выбросили и из
Rawhide </content/Неожиданно-отключили-kdbus-в-fedora>`__. Вместо нее
сейчас, особо не афишируя результаты, разрабатывается
`bus1 <https://github.com/bus1>`__.

Пока держится функционал systemd-networkd, но народ уже недовольно
замечает, что архитектурно реализация отличается от всех остальных
компонентов. Юниты systemd-networkd обрабатываются не на уровне systemd,
а на уровне запущенного сервиса systemd-networkd, и поэтому
присутствовать в графе зависимостей между остальными сервисами не могут.

Это, конечно, проблема, т.к. не получается эффективно реализовать
зависимости между объектами systemd-networkd и остальными юнитами.

Продолжает нарастать антагонизм между подходом Docker и systemd, о чем
уже `высказался Dan Walsh на прошедшем
DevConf.cz <https://lwn.net/Articles/676831/>`__. В последних релизах
systemd, многое было сделано, чтобы облегчить ситуацию, а вот со стороны
Docker контакта нет, и они последовательно отказываются включать в
Docker патчи для совместимости с systemd (обратите внимание на
обсуждения следующих пуллреквестов -
`раз <https://github.com/docker/docker/pull/7685>`__,
`два <https://github.com/docker/docker/pull/10994>`__,
`три <https://github.com/docker/docker/pull/13525>`__,
`четыре <https://github.com/docker/docker/pull/13526>`__). Поскорей бы
народ от Docker отказывался в пользу `более архитектурно правильно
разработанных
альтернатив </content/Великий-Открытый-Контейнерный-Стандарт>`__ (того
же systemd-nspawn).

Интересно, что запуск сервиса без systemd в контейнере, некоторыми
рассматривается, как преимущество Docker. Ну, кроме обычной
systemd-фобии, в этом ничего нет. И как только такие systemd-фобы
приобретут некий опыть работы с сервисами в продакшене, они задаются
странными вопросами, порой оканчивающиеся `созданием примитивной
init-системы <http://engineeringblog.yelp.com/2016/01/dumb-init-an-init-for-docker.html>`__.
Проблематика-то есть, и отрицать ее странно, но systemd это неюниксвэй и
ужос-ужос, вот и приходится мучаться.

Латентные проприетарщики из FreeBSD все так же `костыляют свой аналог
systemd <https://www.opennet.ru/opennews/art.shtml?num=43833>`__. Т.к.
гордость, это плохая замена разуму, то они рассматривают три варианта,
написанных с нуля (ну, с оговорками). Это, кстати, как мы знаем из
истории BSD-систем, скорее всего приведет к еще трем несовместимым
вариантам BSD. В паре вариантов предлагается взять launchd из
проприетарной Mac OS X - так свободнее с т.з. любителей BSD. Во всех
трех вариантах уже удалось реализовать функции systemd - неполностью и
несовместимо, как это всегда и было у всех несовместимых даже между
собой вариантах BSD. Ну пускай, чего уж там.

А пока можно подводить итоги перевода systemd на GitHub. Благодаря
богатой функциональности GitHub, отсутствующей у ряда свободных (с их
т.з.) хостингов, удалось легко `прикрутить CI для всех
пулл-реквестов <https://plus.google.com/+MartinPitti/posts/fjGYfENHo15>`__.
Доступна теперь и формальная статистика, по которой можно `строить
красивые графики и визуализировать здоровье
проекта <https://in.waw.pl/~zbyszek/blog/how-is-systemd-doing-on-github.html>`__.
Пока все выглядит хорошо!

И забавная новость - `systemd теперь используется в электромобилях
BMW <https://geektimes.ru/post/272082/>`__. Как мы и
`предупреждали </content/systemd-теперь-и-в-вашем-bmw>`__. В ВАЗ 2104
никакого systemd не будет, так что волноваться хейтерам не о чем - выбор
всегда будет!
