.. title: Будущее Btrfs
.. slug: budushchee-btrfs
.. date: 2017-08-15 15:59:34 UTC+03:00
.. tags: stratis, xfs, btrfs, eol
.. category: 
.. link: 
.. description: 
.. type: text
.. author: Peter Lemenkov

В RHEL 7.4, вышедшем совсем недавно, `файловая система Btrfs объявлена
deprecated
<https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/7/html/7.4_Release_Notes/chap-Red_Hat_Enterprise_Linux-7.4_Release_Notes-Deprecated_Functionality.html>`_.
Не сложилось.

По опыту нашего коммьюнити, каждый раз, когда очередной смельчак пробует
использовать Btrfs, это обязательно заканчивается неисправимой ошибкой файловой
системы. Поэтому мы рекомендуем не использовать ее для раздела ~/. Но как же
`ее используют в Facebook
<https://www.linux.com/news/learn/intro-to-linux/how-facebook-uses-linux-and-btrfs-interview-chris-mason>`_?
Ну во-первых сравните сценарии - накроется в FB файловая система, так целый
комп переустановят с нуля, засинхронизируют данные, и готово! А вы что делать
будете? Ну и во-вторых, если упадет что-то чужое навсегда, то вы сильно станете
жалеть? Вот то-то же. А свое жалко.

Ситуацию с нестабильностью Btrfs усугубляло то, что каждый раз разработчики
обещали, что оно вот-вот будет готово. Не готово до сих пор, и бэкпортировать
быстро движущуюся цель на стабильные ядра тоже `удовольствия мало
<https://news.ycombinator.com/item?id=14909843>`_. Самое интересно, это то,
зачем возиться с Btrfs, когда все ее фичи (подчеркнем, вообще все) доступны в
других утилитах или компонентах ядра. Уже есть управление томами и разделами,
есть надежная журналируемая файловая система (XFS), есть дедупликация, thin
provisioning, шифрование, создание снапшотов - нужно только правильно,
по-юниксвэйному все организовать.

Создав список необходимого функционала, наши коллеги предложили `Stratis
<https://github.com/stratis-storage>`_, написанный на Rust и Python фреймворк,
использующий device-mapper и XFS. Если все пойдет хорошо, то `первая версия
будет доступна уже в Fedora 28
<https://fedoraproject.org/wiki/Changes/StratisStorage>`_. Если же все пойдет
совсем хорошо, то к версии 3 планируется полностью реализовать функционал ZFS.

Ответим на напрашивающийся вопрос - что насчет ZFS? К сожалению, нет. Эта FS,
по-видимому, `никогда не будет предложена для включения в Linux
<https://roem.ru/10-10-2016/231632/oracle-vs-google/>`_.

Еще один вопрос - что будет с Btrfs в Fedora? Она там будет доступна.
Бэкпортировать в Fedora ничего не нужно, и поэтому там ситуация гораздо проще.
Пользуйтесь на здоровье, но не забывайте бэкапиться, т.к. она наверняка рухнет.

Вообще, напомню, `файловые системы вскоре сильно изменятся
</content/История-xfs-и-будущее-фс-в-целом/>`_, т.к. меняется сам носитель, на
который записываются данные. И такие ФС начинают появляться! Например, недавно
была анонсирована такая ФС - `NOVA
<http://nvsl.ucsd.edu/index.php?path=projects/nova>`_ (новость уже `обсуждают
на OpenNET.ru <https://www.opennet.ru/opennews/art.shtml?num=46977>`_).
